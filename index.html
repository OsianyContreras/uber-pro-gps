<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <title>UBERTRON PRO VISION</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- React -->
    <script src="https://unpkg.com/react@17/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>

    <!-- ESTILOS ORIGINALES (NO TOCADOS) -->
    <link rel="stylesheet" href="styles.css">
</head>

<body>
<div id="root"></div>

<script type="text/babel">

function App() {

    const [extractedText, setExtractedText] = React.useState("");

    /* ===============================
       COPIAR AL PORTAPAPELES
    =============================== */
    function copyToClipboard(text) {
        navigator.clipboard.writeText(text);
        alert("Texto copiado al portapapeles");
    }

    /* ===============================
       COMPARTIR (USA EL MISMO TEXTO)
    =============================== */
    function shareText(text) {
        if (navigator.share) {
            navigator.share({
                title: "UBERTRON PRO VISION",
                text: text
            });
        } else {
            copyToClipboard(text);
            alert("Tu dispositivo no soporta compartir directo. Texto copiado.");
        }
    }

    /* ===============================
       BUSCAR COORDENADAS O DIRECCIONES
    =============================== */
    function extractLocations(text) {

        // 1Ô∏è‚É£ Coordenadas (PRIORIDAD)
        const coordRegex = /(-?\d{1,2}\.\d+)[,\s]+(-?\d{1,3}\.\d+)/g;
        let coords = text.match(coordRegex);

        if (coords && coords.length > 0) {
            return coords.join("\n");
        }

        // 2Ô∏è‚É£ Direcciones completas (FALLBACK)
        const addressRegex =
            /([A-Z√Å√â√ç√ì√ö√ë][a-z√°√©√≠√≥√∫√±]+(?:\s+[A-Z√Å√â√ç√ì√ö√ëa-z√°√©√≠√≥√∫√±]+)*\s+\d+.*?(?:Ciudad|Colonia|Estado|M√©xico|USA|Estados Unidos)?)/g;

        let addresses = text.match(addressRegex);

        if (addresses && addresses.length > 0) {
            return addresses.join("\n");
        }

        return "No se detectaron coordenadas ni direcciones.";
    }

    const detectedLocations = extractLocations(extractedText);

    return (
        <div className="app-container">

            <main className="main-content">

                <div className="glass-card">

                    <h2>RESULTADOS DETECTADOS</h2>

                    <textarea
                        value={detectedLocations}
                        readOnly
                        style={{ width: "100%", height: "160px" }}
                    />

                    {/* ===============================
                        BOTONES EN LA MISMA L√çNEA
                    =============================== */}
                    <div style={{
                        display: "flex",
                        gap: "10px",
                        marginTop: "12px"
                    }}>

                        {/* BOT√ìN COPIAR (M√ÅS PEQUE√ëO) */}
                        <button
                            className="action-btn"
                            style={{ padding: "8px 12px", fontSize: "12px" }}
                            onClick={() => copyToClipboard(detectedLocations)}
                        >
                            üìã COPIAR
                        </button>

                        {/* BOT√ìN COMPARTIR */}
                        <button
                            className="action-btn"
                            style={{ padding: "8px 12px", fontSize: "12px" }}
                            onClick={() => shareText(detectedLocations)}
                        >
                            üì§ COMPARTIR
                        </button>

                    </div>

                </div>

            </main>

            <footer className="app-footer">
                <p>UBERTRON PRO VISION v5.0</p>
            </footer>

        </div>
    );
}

ReactDOM.render(<App />, document.getElementById("root"));

</script>
</body>
</html>
