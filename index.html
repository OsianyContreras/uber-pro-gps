<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ubertron Pro-Vision</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Rajdhani:wght@300;500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
    <style>
        :root {
            --neon-green: #39FF14;
            --neon-blue: #0ea5e9;
            --bg-dark: #020617;
            --glass: rgba(15, 23, 42, 0.8);
        }

        /* Fondo Animado de PartÃ­culas */
        body {
            margin: 0; padding: 0;
            font-family: 'Rajdhani', sans-serif;
            background: radial-gradient(circle at center, #0f172a 0%, #000 100%);
            color: #fff;
            display: flex; justify-content: center; min-height: 100vh; align-items: center;
            overflow-x: hidden;
        }

        body::before {
            content: ""; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-image: radial-gradient(var(--neon-green) 1px, transparent 1px);
            background-size: 50px 50px; opacity: 0.05; z-index: -1;
        }

        /* Tarjeta Estilo Glassmorphism */
        .card {
            width: 100%; max-width: 380px; margin: 20px; padding: 30px;
            border-radius: 30px; background: var(--glass);
            backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative; box-shadow: 0 0 40px rgba(0,0,0,0.8);
            animation: fadeIn 0.8s ease;
        }

        /* Borde Infinity Mirror Animado */
        .card::after {
            content: ""; position: absolute; inset: -2px; border-radius: 32px;
            background: linear-gradient(var(--neon-green), var(--neon-blue), var(--neon-green));
            z-index: -1; filter: blur(10px); opacity: 0.4;
            animation: borderRotate 4s linear infinite;
        }

        @keyframes borderRotate { 0% { filter: hue-rotate(0deg); } 100% { filter: hue-rotate(360deg); } }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        h1 {
            font-family: 'Orbitron', sans-serif; font-size: 22px; text-align: center;
            margin: 0 0 20px; color: var(--neon-green); text-shadow: 0 0 10px var(--neon-green);
            letter-spacing: 2px;
        }

        /* Selector de Archivos */
        input[type=file] {
            width: 100%; padding: 10px; background: rgba(255,255,255,0.05);
            border-radius: 12px; margin-bottom: 20px; color: var(--text-dim); border: 1px dashed var(--neon-blue);
        }

        /* Contenedor de Imagen y LÃ¡ser */
        .img-box {
            position: relative; border-radius: 15px; overflow: hidden;
            background: #000; border: 1px solid rgba(57, 255, 20, 0.2);
        }
        img { width: 100%; max-height: 250px; object-fit: contain; display: none; }
        img.loaded { display: block; animation: glitch 0.3s ease; }

        .laser {
            position: absolute; top: 0; left: 0; width: 100%; height: 3px;
            background: var(--neon-green); box-shadow: 0 0 20px var(--neon-green);
            display: none; z-index: 5;
        }
        .scanning .laser { display: block; animation: scan 2s infinite ease-in-out; }

        @keyframes scan { 0% { top: 0%; } 50% { top: 100%; } 100% { top: 0%; } }
        @keyframes glitch { 0% { transform: translate(2px,2px); } 50% { transform: translate(-2px,-2px); } 100% { transform: translate(0); } }

        /* Coordenadas Neon */
        .coords {
            margin-top: 25px; padding: 20px; border-radius: 20px;
            background: rgba(0, 0, 0, 0.5); border: 2px solid var(--neon-green);
            box-shadow: inset 0 0 15px rgba(57, 255, 20, 0.2), 0 0 20px rgba(57, 255, 20, 0.2);
            text-align: center; opacity: 0; transform: scale(0.9); transition: 0.4s;
        }
        .coords.show { opacity: 1; transform: scale(1); }
        .coords b { font-family: 'Orbitron', sans-serif; font-size: 1.5em; color: #fff; text-shadow: 0 0 8px var(--neon-green); }
        .label { font-size: 11px; color: var(--neon-blue); letter-spacing: 2px; margin-bottom: 5px; display: block; }

        /* Botones */
        button {
            width: 100%; padding: 18px; margin-top: 15px; border-radius: 15px;
            border: none; font-family: 'Orbitron', sans-serif; font-weight: 700;
            cursor: pointer; transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .btn-analyze { background: var(--neon-green); color: #000; box-shadow: 0 0 20px rgba(57, 255, 20, 0.4); }
        .btn-share { background: var(--neon-blue); color: #fff; display: none; box-shadow: 0 0 20px rgba(14, 165, 233, 0.4); }
        .btn-danger { background: transparent; color: #ef4444; border: 1px solid #ef4444; margin-top: 25px; font-size: 12px; }
        
        button:active { transform: scale(0.92); }
        .btn-share.show { display: block; animation: fadeIn 0.4s ease; }

        /* Historial */
        .history-list { display: flex; justify-content: center; gap: 15px; margin-top: 15px; }
        .history-item { 
            width: 50px; height: 50px; border-radius: 12px; border: 1px solid var(--neon-blue);
            display: flex; align-items: center; justify-content: center; font-size: 10px;
            color: var(--neon-blue); cursor: pointer; background: rgba(14, 165, 233, 0.05);
            transition: 0.3s;
        }
        .history-item:hover { background: var(--neon-blue); color: #fff; box-shadow: 0 0 15px var(--neon-blue); }

        .copyright { margin-top: 30px; text-align: center; font-size: 10px; color: rgba(255,255,255,0.3); letter-spacing: 2px; }
        
        /* Toast NeÃ³n */
        .toast {
            position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%) translateY(50px);
            background: var(--neon-green); color: #000; padding: 12px 30px; border-radius: 50px;
            font-weight: 800; opacity: 0; transition: 0.4s; z-index: 1000;
        }
        .toast.show { opacity: 1; transform: translateX(-50%) translateY(0); }
    </style>
</head>
<body>

<div class="card">
    <h1>UBERTRON PRO</h1>
    
    <input type="file" id="fileInput" accept="image/*">
    
    <div class="img-box" id="imgBox">
        <div class="laser"></div>
        <img id="preview">
    </div>
    
    <button id="analyzeBtn" class="btn-analyze">SCAN_VISION</button>
    
    <div id="status" style="text-align:center; margin-top:12px; font-size:12px; color:var(--neon-blue);">SISTEMA ONLINE</div>

    <div class="coords" id="coordsBlock">
        <span class="label">DATA_COORDINATES</span>
        <b id="latVal">0.0000</b><br>
        <b id="lngVal">0.0000</b>
    </div>

    <button id="shareBtn" class="btn-share" onclick="copiarYCompartir()">ðŸš€ ENVIAR A SYGIC</button>

    <div style="text-align:center; font-size:10px; color:rgba(255,255,255,0.3); margin-top:20px;">RECOVERY_LOGS</div>
    <div class="history-list" id="historyList"></div>

    <button onclick="location.reload()" class="btn-danger">RESET_SYSTEM</button>

    <div class="copyright">@Copyright: Osiany2026</div>
</div>

<div id="toast" class="toast">DATA_COPIED_SUCCESS</div>

<script>
let currentLat = null, currentLng = null;
const historyKey = "gps_history_tron";

// --- FUNCIÃ“N COPIAR Y COMPARTIR ---
async function copiarYCompartir() {
    if (!currentLat || !currentLng) return;
    
    // Copiar
    const text = `${currentLat},${currentLng}`;
    const el = document.createElement('textarea');
    el.value = text;
    document.body.appendChild(el);
    el.select();
    document.execCommand('copy');
    document.body.removeChild(el);
    
    // Compartir
    const mapUrl = `http://maps.apple.com/?q=${currentLat},${currentLng}`;
    if (navigator.share) {
        try {
            await navigator.share({
                title: 'Tron Location',
                text: text,
                url: mapUrl
            });
        } catch (err) {}
    }
    mostrarToast("âœ… COPIADO & COMPARTIENDO");
}

// --- HISTORIAL ---
function saveToHistory(lat, lng) {
    let history = JSON.parse(localStorage.getItem(historyKey) || "[]");
    history.unshift({lat, lng, time: new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})});
    history = history.slice(0, 3);
    localStorage.setItem(historyKey, JSON.stringify(history));
    renderHistory();
}

function renderHistory() {
    const container = document.getElementById("historyList");
    const history = JSON.parse(localStorage.getItem(historyKey) || "[]");
    container.innerHTML = history.map(item => `
        <div class="history-item" onclick="loadFromHistory('${item.lat}','${item.lng}')">
            ${item.time}
        </div>
    `).join("");
}

function loadFromHistory(lat, lng) {
    currentLat = lat; currentLng = lng;
    document.getElementById("latVal").textContent = lat;
    document.getElementById("lngVal").textContent = lng;
    document.getElementById("coordsBlock").classList.add("show");
    document.getElementById("shareBtn").classList.add("show");
    mostrarToast("RELOAD_DATA_SUCCESS");
}

function mostrarToast(msg) {
    const t = document.getElementById("toast");
    t.textContent = msg;
    t.classList.add("show");
    if(navigator.vibrate) navigator.vibrate(50);
    setTimeout(() => t.classList.remove("show"), 2000);
}

// --- PROCESO ---
document.getElementById("fileInput").onchange = e => {
    const f = e.target.files[0];
    if(!f) return;
    const img = document.getElementById("preview");
    img.src = URL.createObjectURL(f);
    img.classList.add("loaded");
    document.getElementById("status").textContent = "DATA_READY_FOR_SCAN";
};

document.getElementById("analyzeBtn").onclick = async () => {
    const img = document.getElementById("preview");
    if(!img.src) return alert("NO_IMAGE_DETECTED");
    
    document.getElementById("imgBox").classList.add("scanning");
    document.getElementById("status").textContent = "EXECUTING_OCR_SCAN...";
    document.getElementById("analyzeBtn").disabled = true;

    try {
        const r = await Tesseract.recognize(img.src, "eng");
        const m = r.data.text.match(/(-?\d{1,2}\.\d+)[,\s\n]+(-?\d{1,3}\.\d+)/);
        
        if(!m) throw "ERROR_COORDINATES_NOT_FOUND";

        currentLat = m[1];
        currentLng = m[2];

        document.getElementById("latVal").textContent = currentLat;
        document.getElementById("lngVal").textContent = currentLng;
        document.getElementById("coordsBlock").classList.add("show");
        document.getElementById("shareBtn").classList.add("show");
        document.getElementById("status").textContent = "SCAN_COMPLETE_100%";
        
        saveToHistory(currentLat, currentLng);
    } catch(e) {
        document.getElementById("status").textContent = "CRITICAL_ERROR_SCAN";
        alert(e);
    } finally {
        document.getElementById("imgBox").classList.remove("scanning");
        document.getElementById("analyzeBtn").disabled = false;
    }
};

renderHistory();
</script>
</body>
</html>

